"0","# This one is parametric (poisson)
model.forest.2 = (function(M=100, C=3){
  # C is number of covariates picked
  
  baseTree = model.tree.1 # See above
  
  nr = nrow(base_train)
  nrTest = nrow(base_test)
  sampleSize = nr
  
  
  allResults = matrix(NA, M, nrTest)
  for (i in 1:M){
    
    baseFit = predict(baseTree, base_train)
    baseFitNbclaims = rpois(nr, basefit*base_train$Exposure)
    
    trainSample = base_train
    trainSample$Nbclaims = baseFitNbclaims # Replace by predicted
    
    covSample = sample(formule.covariates, C)
    equation = paste(""cbind(Exposure, Nbclaims) ~ "", paste(covSample, collapse = "" + ""))
    
    tree = rpart(equation, data=trainSample, method=""poisson"", control=rpart.control(cp=0.001, xval = 10))
    allResults[i,] = predict(tree, base_test_ordered)
  }
  
  return (colMeans(allResults))
})()
"
"2","Error in rpois(nr, basefit * base_train$Exposure) : 
  object 'basefit' not found
"
