"0","# ---"
"0","formule.covariates = c(""Gender"", ""DriverAge"", ""CarAge"", ""Area"", ""Leasing"", ""Power"", ""Fract"", ""Contract"")"
"0",""
"0","formule.long.offset = as.formula(paste(""Nbclaims ~ offset(log(Exposure)) + "", paste(formule.covariates, collapse="" + "")))"
"0",""
"0","formule.long = as.formula(paste(""Nbclaims ~ "", paste(formule.covariates, collapse="" + "")))"
"0",""
"0","formule.step = as.formula(Nbclaims ~ Gender + DriverAge + Area + Leasing + "
"0","    Power + Fract + offset(log(Exposure)))"
"0",""
"0","customDeviance = function(fitt){"
"0","  y = base_train_freq$Frequency"
"0","  w = base_train$Exposure"
"0","  "
"0","  left = y * log(y) - y * log(fitt)"
"0","  right = y - fitt"
"0","  "
"0","  left[y==0] = 0 # Replace NA's by 0 because log(0) is -Inf but 0*Inf ~ 0"
"0","  "
"0","  return(2*sum(w*(left-right)))"
"0","}"
"0",""
